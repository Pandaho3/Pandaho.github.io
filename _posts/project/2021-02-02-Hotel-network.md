---
title: 酒店网络应急预案
author: Pandaho
date: 2021-02-02 20:00:00 
categories: [Project] 
tags: [network]
image: /assets/img/Hotel-network/cover.png
---



##  前言

​	酒店作为服务行业，核心便是服务，而保障网络也便是其中的基础，现代社会万物互联，人的日常已经离不开电子产品的辅助，而电子产品之间的互联也离不开这千丝万缕的网络链路，那如何保证一个酒店365天无间断的提供高质量的网络服务呢？这便需要对网络进行冗余。任何需要具备高可靠性或者在关键场合应用的网络，都需要数据通道冗余，在一条路径出现故障的时候有另外一条保证通讯畅通。实施网络冗余策略，需要取决于很多因素，其中很大程度上要依赖于应用和现有的网络拓扑结构—也就是系统、流程和设备的部署情况和位置，以及线缆的架构。简单说，特定的冗余方法适用于特定的系统配置。

 我分享一份我在一家工作时，撰写的冗余方案，从上至下在保证现网的情况下对整个网络架构进行冗余。

## 一、出口带宽的故障应急方案

​	酒店的网络流量一般都分为客人使用和内部使用，那我们可以租用两条不同运营商的专线带宽，采用路由策略或策略路由对业务流量进行分流，这样可以保障当一家运营商在本区域网络故障的情况下，我还能保障我的网络业务不中断。

对不同业务流量制定不同acl，然后对不同出口带宽制定不同策略，再通过NQA与策略路由联动实现专线故障无缝切换。

### 知识要领
路由策略与策略路由
![图例](https://www.pandaho3.cn/assets/img/Hotel-network/1.png)
NQA是一种实时的网络性能探测和统计技术，可以对响应时间、网络抖动、丢包率等网络信息进行统计。
NQA还提供了与Track和应用模块联动的功能，实时监控网络状态的变化。
ICMP-echo功能是NQA最基本的功能，遵循RFC 2925来实现，其实现原理是通过发送ICMP报文来判断目的地的可达性、计算网络响应时间及丢包率。
ICMP-echo测试成功的前提条件是目的设备要能够正确响应ICMP echo request报文。NQA客户端会根据设置的探测时间及频率向探测的目的IP地址发ICMP echo request报文，目的地址收到ICMP echo request报文后，回复ICMP echo reply报文。NQA客户端根据ICMP echo reply报文的接收情况，如接收时间和报文个数，计算出到目的IP地址的响应时间及丢包率，从而反映当前的网络性能及网络情况。
ICMP-echo测试的结果和历史记录将记录在测试组中，可以通过命令行来查看探测结果和历史记录。
IP单播策略路由通过与NQA、Track联动，增加了应用的灵活性，增强了策略路由对网络环境的动态感知能力。
策略路由可以在配置报文的发送接口、缺省发送接口、下一跳、缺省下一跳时，通过Track与NQA关联。如果NQA探测成功，则该策略有效，可以指导转发；如果探测失败，则该策略无效，转发时忽略该策略。

## 二、设备间的冗余和堆叠
设备冗余我们可以采用RFC 5798标准的虚拟路由冗余协议(Virtual Router Redundancy Protocol，简称VRRP)或各厂商自己的堆叠方案，再对链路进行聚合，保证网络故障的快速恢复。
### 知识要领
虚拟路由器冗余协议（英语：Virtual Router Redundancy Protocol，缩写为 VRRP）是一种网络协议，可以为参与的路由器自动分配可用的IP地址。这个协议通过在子网中，自动选取默认网关，来增加路由的可用性和可靠性。
这个协议首先创建了一些虚拟路由器（这是对多个路由器的抽象），例如：主路由器、备路由器，这些路由器作为一个 group 协同工作。虚拟路由器被配置为默认网关，而不是物理路由器。当正在工作的物理路由器（代表着虚拟路由器）发生故障时，另一个物理路由器会自动被选举出来替代它。特定时间内正在转发数据包的物理路由器被称为主路由器。 VRRP提供了路由器状态的信息，而不是该路由器的数据包处理、交换的信息。每一个VRRP实例被限制到单一子网内。它不会参与子网外的IP路由，也不会以任何方式影响路由表。VRRP可以通过IPv4或者IPv6（三层IP网），运行在Ethernet（以太网）、MPLS和令牌环网络（二层链路网）。
注：出自维基百科
